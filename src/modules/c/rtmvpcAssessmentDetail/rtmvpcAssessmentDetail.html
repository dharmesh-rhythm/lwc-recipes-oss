<template>
    <div class="main-container">
        <!-- Tab Navigation
        <div class="tab-container">
            <button type="button" class={responsesTabClass} aria-selected={isResponsesTabActive} data-tab="responses" onclick={handleTabSwitch}>Responses</button>
            <button type="button" class={reportsTabClass} aria-selected={isReportsTabActive} data-tab="reports" onclick={handleTabSwitch}>Reports</button>
        </div>
    -->

        <div class="assessment-container">
            <template if:true={viewResponse}>
                <div class="card">
                    <!-- Timeline Panel -->
                    <div class={timelinePanelClass}>
                        <div class="panel-header timeline-header">
                            <span class="timeline-title"
                                ><b>{labels.timeLine}</b></span
                            >
                            <template if:true={isTimelinePanelVisible}>
                                <button
                                    class="icon-button"
                                    onclick={handleLeftButtonClick}
                                    title="Close Timeline Panel"
                                >
                                    <!-- Chevron Left SVG -->
                                    <svg
                                        width="20"
                                        height="20"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                    >
                                        <path
                                            d="M15 6l-6 6 6 6"
                                            stroke="#5a3e84"
                                            stroke-width="2"
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                        />
                                    </svg>
                                </button>
                            </template>
                        </div>
                        <div class="timeline-container">
                            <div class="timeline-scroll">
                                <template
                                    for:each={assessmentTimeline}
                                    for:item="assessment"
                                >
                                    <div
                                        key={assessment.id}
                                        class={assessment.classlist}
                                    >
                                        <div class="timeline-date-wrapper">
                                            <span class="timeline-day"
                                                >{assessment.day}</span
                                            >
                                            <span class="timeline-date"
                                                >{assessment.date}</span
                                            >
                                        </div>
                                        <div class="timeline-dot-container">
                                            <div class="timeline-dot">
                                                <!-- In Review Icon -->
                                                <template
                                                    if:true={assessment.isInReview}
                                                >
                                                    <svg
                                                        xmlns="http://www.w3.org/2000/svg"
                                                        width="10"
                                                        height="10"
                                                        viewBox="0 0 24 24"
                                                        fill="none"
                                                        stroke="currentColor"
                                                        stroke-width="2.5"
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                    >
                                                        <circle
                                                            cx="12"
                                                            cy="12"
                                                            r="10"
                                                        ></circle>
                                                        <circle
                                                            cx="12"
                                                            cy="12"
                                                            r="4"
                                                        ></circle>
                                                    </svg>
                                                </template>
                                                <!-- Submitted/Completed Icon -->
                                                <template
                                                    if:true={assessment.isSubmitted}
                                                >
                                                    <svg
                                                        xmlns="http://www.w3.org/2000/svg"
                                                        width="10"
                                                        height="10"
                                                        viewBox="0 0 24 24"
                                                        fill="none"
                                                        stroke="currentColor"
                                                        stroke-width="2.5"
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                    >
                                                        <polyline
                                                            points="20 6 9 17 4 12"
                                                        ></polyline>
                                                    </svg>
                                                </template>
                                                <!-- In Progress Icon -->
                                                <template
                                                    if:true={assessment.isInProgress}
                                                >
                                                    <svg
                                                        xmlns="http://www.w3.org/2000/svg"
                                                        width="10"
                                                        height="10"
                                                        viewBox="0 0 24 24"
                                                        fill="none"
                                                        stroke="currentColor"
                                                        stroke-width="2.5"
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                    >
                                                        <circle
                                                            cx="12"
                                                            cy="12"
                                                            r="10"
                                                        ></circle>
                                                        <line
                                                            x1="12"
                                                            y1="8"
                                                            x2="12"
                                                            y2="12"
                                                        ></line>
                                                        <line
                                                            x1="12"
                                                            y1="16"
                                                            x2="12.01"
                                                            y2="16"
                                                        ></line>
                                                    </svg>
                                                </template>
                                                <!-- Start Date Icon -->
                                                <template
                                                    if:true={assessment.isStartDate}
                                                >
                                                    <svg
                                                        xmlns="http://www.w3.org/2000/svg"
                                                        width="10"
                                                        height="10"
                                                        viewBox="0 0 24 24"
                                                        fill="none"
                                                        stroke="currentColor"
                                                        stroke-width="2.5"
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                    >
                                                        <circle
                                                            cx="12"
                                                            cy="12"
                                                            r="3"
                                                        ></circle>
                                                        <path
                                                            d="M12 1v6m0 6v6m11-7h-6m-6 0H1"
                                                        ></path>
                                                    </svg>
                                                </template>
                                            </div>
                                        </div>
                                        <div>
                                            <h3 class="timeline-title">
                                                {assessment.status}
                                            </h3>

                                            <p class="timeline-user">
                                                {assessment.name}
                                            </p>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>

                    <!-- Main Content -->
                    <div class="main-panel">
                        <div class="panel-header">
                            <template if:false={isTimelinePanelVisible}>
                                <button
                                    class="icon-button toggle-timeline"
                                    onclick={handleLeftButtonClick}
                                    title="Open Timeline Panel"
                                >
                                    <!-- Chevron Right SVG -->
                                    <svg
                                        width="20"
                                        height="20"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                    >
                                        <path
                                            d="M9 6l6 6-6 6"
                                            stroke="#5a3e84"
                                            stroke-width="2"
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                        />
                                    </svg>
                                </button>
                            </template>
                            <div class="assessment-header-info">
                                <p class="assessment-name">
                                    <b
                                        >Details:
                                        {assessmentData.assessmentName}
                                        {assessmentData.endDate}</b
                                    >
                                </p>
                            </div>

                            <!-- Control buttons -->
                            <div class="header-controls">
                                <!-- Edit button -->
                                <button
                                    class="icon-button edit-button { isEditing: 'editing-active' }"
                                    onclick={toggleEditMode}
                                    title="Edit"
                                >
                                    <svg
                                        width="20"
                                        height="20"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                    >
                                        <path
                                            d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"
                                            stroke="#5a3e84"
                                            stroke-width="2"
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                        />
                                    </svg>
                                </button>

                                <!-- Expand/Collapse All button -->
                                <template if:true={showExpand}>
                                    <button
                                        class="icon-button expand-all-button"
                                        onclick={handleAccordian}
                                        title="Expand All"
                                    >
                                        <svg
                                            width="20"
                                            height="20"
                                            viewBox="0 0 24 24"
                                            fill="none"
                                            xmlns="http://www.w3.org/2000/svg"
                                        >
                                            <path
                                                d="M12 5v14m-7-7h14"
                                                stroke="#5a3e84"
                                                stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                            />
                                        </svg>
                                    </button>
                                </template>
                                <template if:false={showExpand}>
                                    <button
                                        class="icon-button expand-all-button"
                                        onclick={handleAccordian}
                                        title="Collapse All"
                                    >
                                        <svg
                                            width="20"
                                            height="20"
                                            viewBox="0 0 24 24"
                                            fill="none"
                                            xmlns="http://www.w3.org/2000/svg"
                                        >
                                            <path
                                                d="M5 12h14"
                                                stroke="#5a3e84"
                                                stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                            />
                                        </svg>
                                    </button>
                                </template>

                                <!-- Filter dropdown -->
                                <template if:true={showstatus}>
                                    <div
                                        class="dropdown-wrapper filter-wrapper"
                                    >
                                        <button
                                            class="icon-button filter-button"
                                            onclick={toggleFilterMenu}
                                            title="Filtering"
                                        >
                                            <svg
                                                class="filter-icon"
                                                xmlns="http://www.w3.org/2000/svg"
                                                width="18"
                                                height="18"
                                                viewBox="0 0 24 24"
                                            >
                                                <path
                                                    d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"
                                                ></path>
                                            </svg>
                                        </button>
                                        <div class={filterDropdownClass}>
                                            <ul class="filter-menu">
                                                <li
                                                    class={isAllSelected}
                                                    onclick={handleChange}
                                                    data-id="All"
                                                >
                                                    {labels.SP_All}
                                                </li>
                                                <li
                                                    class={isLowerFlagSelected}
                                                    onclick={handleChange}
                                                    data-id="showlowerflag"
                                                >
                                                    {labels.SP_Flagged}
                                                </li>
                                                <li
                                                    class={isApprovedSelected}
                                                    onclick={handleApproveChange}
                                                    data-id="showapproved"
                                                >
                                                    {labels.SP_Approved}
                                                </li>
                                                <li
                                                    class={isRejectedSelected}
                                                    onclick={handleRejectChange}
                                                    data-id="showrejected"
                                                >
                                                    {labels.SP_Rejected}
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </template>

                                <!-- Edit button 
                <template if:true={showEditIconCustomer}>
                  <template if:true={showEditIcon}>
                    <button class="icon-button" onclick={handleEdit} title="Edit" data-id="EditTrue" disabled={mockData.isIconDisabled}>
                      <span class="icon icon-pencil"></span>
                    </button>
                  </template>
                  <template if:false={showEditIcon}>
                    <button class="icon-button" onclick={handleEdit} title="Edit" data-id="EditFalse" disabled={mockData.isIconDisabled}>
                      <span class="icon icon-edit"></span>
                    </button>
                  </template>
                </template>
              -->

                                <!-- Export dropdown -->
                                <template if:true={showdownloadIcon}>
                                    <div
                                        class="dropdown-wrapper filter-wrapper"
                                    >
                                        <button
                                            class="icon-button export-button"
                                            onclick={toggleExportMenu}
                                            title="Export"
                                        >
                                            <svg
                                                class="export-icon"
                                                xmlns="http://www.w3.org/2000/svg"
                                                width="20"
                                                height="20"
                                                viewBox="0 0 24 24"
                                                fill="none"
                                            >
                                                <path
                                                    d="M12 3v12m0 0l-4-4m4 4l4-4M5 21h14"
                                                    stroke="#5a3e84"
                                                    stroke-width="2"
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                />
                                            </svg>
                                        </button>
                                        <ul class={exportMenuClass}>
                                            <li
                                                onclick={handleExportPDF}
                                                title="PDF"
                                            >
                                                PDF
                                            </li>
                                            <li
                                                onclick={handleExportCSV}
                                                title="CSV"
                                            >
                                                CSV
                                            </li>
                                        </ul>
                                    </div>
                                </template>

                                <!-- Right Panel toggle button -->
                                <button
                                    lwc:if={isRightPanelOpen}
                                    class="icon-button"
                                    onclick={handleRightButtonClick}
                                    title="Toggle Right Panel"
                                >
                                    <svg
                                        width="20"
                                        height="20"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                    >
                                        <path
                                            d="M9 6l6 6-6 6"
                                            stroke="#5a3e84"
                                            stroke-width="2"
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                        />
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- Assessment Areas -->
                        <div class="assessment-areas">
                            <template
                                for:each={assessmentAreas}
                                for:item="area"
                            >
                                <div key={area.id} class="assessment-area">
                                    <div
                                        class="area-header"
                                        onclick={toggleAreaDetails}
                                        data-id={area.id}
                                    >
                                        <div class="area-icon">
                                            <template if:true={area.expanded}>
                                                <!-- Down Arrow SVG -->
                                                <svg
                                                    width="20"
                                                    height="20"
                                                    viewBox="0 0 24 24"
                                                    fill="none"
                                                >
                                                    <path
                                                        d="M6 9l6 6 6-6"
                                                        stroke="#5a3e84"
                                                        stroke-width="2"
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                    />
                                                </svg>
                                            </template>
                                            <template if:false={area.expanded}>
                                                <!-- Right Arrow SVG -->
                                                <svg
                                                    width="20"
                                                    height="20"
                                                    viewBox="0 0 24 24"
                                                    fill="none"
                                                >
                                                    <path
                                                        d="M9 6l6 6-6 6"
                                                        stroke="#5a3e84"
                                                        stroke-width="2"
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                    />
                                                </svg>
                                            </template>
                                        </div>
                                        <div
                                            class="area-title"
                                            onclick={handleAreaTitleClick}
                                        >
                                            {area.title}
                                        </div>
                                        <div class="area-metrics">
                                            <div class="area-metric">
                                                <span class="metric-label"
                                                    >{labels.totalCount}</span
                                                >
                                                <span class="metric-value"
                                                    >{area.computedMetrics.totalCount}</span
                                                >
                                            </div>
                                            <div class="area-metric">
                                                <span class="metric-label"
                                                    >{labels.completed}</span
                                                >
                                                <span class="metric-value"
                                                    >{area.computedMetrics.completed}</span
                                                >
                                            </div>
                                            <div class="area-metric">
                                                <span class="metric-label"
                                                    >{labels.score}</span
                                                >
                                                <span class="metric-value"
                                                    >{area.computedMetrics.score}</span
                                                >
                                            </div>
                                            <div class="area-metric">
                                                <span class="metric-label"
                                                    >{labels.followUps}</span
                                                >
                                                <span class="metric-value"
                                                    >{area.computedMetrics.followUps}</span
                                                >
                                            </div>
                                            <div class="area-metric">
                                                <span class="metric-label"
                                                    >{labels.findings}</span
                                                >
                                                <span class="metric-value"
                                                    >{area.computedMetrics.findings}</span
                                                >
                                            </div>
                                            <div class="area-metric">
                                                <span class="metric-label"
                                                    >{labels.tasks}</span
                                                >
                                                <span class="metric-value"
                                                    >{area.computedMetrics.tasks}</span
                                                >
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Area details section that appears when expanded -->
                                    <template if:true={area.expanded}>
                                        <div class="area-details">
                                            <!-- Loop through questions in this area -->
                                            <template
                                                for:each={area.questions}
                                                for:item="question"
                                                for:index="questionIndex"
                                            >
                                                <div
                                                    key={question.id}
                                                    class="area-content"
                                                >
                                                    <p>{question.question}</p>
                                                    <div class="response-input">
                                                        <input
                                                            type={question.Rhythm__Question_Type__c}
                                                            placeholder="Enter your response here..."
                                                            data-area-id={area.id}
                                                            data-question-id={question.id}
                                                            onchange={handleResponseChange}
                                                            value={question.response}
                                                        />
                                                    </div>
                                                    <!-- <div class="response-status">
                                                        <template if:true={question.responseSaved}>
                                                            <span class="saved">✓ Response saved</span>
                                                        </template>
                                                        <template if:true={question.responseError}>
                                                            <span class="error">⚠ Error saving response</span>
                                                        </template>
                                                        <button class="submit-response-button" onclick={handleSubmitResponse} data-area-id={area.id} data-question-id={question.id}>
                                                            Submit Response
                                                        </button>
                                                    </div> -->

                                                    <!-- Action buttons for each question -->
                                                    <div class="area-actions">
                                                        <button
                                                            class="action-button icon-action"
                                                            onclick={showComments}
                                                            data-area-id={area.id}
                                                            data-question-id={question.id}
                                                            title="Follow-up"
                                                        >
                                                            <svg
                                                                xmlns="http://www.w3.org/2000/svg"
                                                                width="20"
                                                                height="20"
                                                                viewBox="0 0 24 24"
                                                                fill="none"
                                                                stroke="currentColor"
                                                                stroke-width="2"
                                                                stroke-linecap="round"
                                                                stroke-linejoin="round"
                                                            >
                                                                <path
                                                                    d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"
                                                                ></path>
                                                            </svg>
                                                            <span
                                                                class="action-label"
                                                                >Follow-up</span
                                                            >
                                                        </button>
                                                        <button
                                                            class="action-button icon-action"
                                                            onclick={showFindingsAndTasks}
                                                            data-area-id={area.id}
                                                            data-question-id={question.id}
                                                            title="Findings and Tasks"
                                                        >
                                                            <svg
                                                                xmlns="http://www.w3.org/2000/svg"
                                                                width="20"
                                                                height="20"
                                                                viewBox="0 0 24 24"
                                                                fill="none"
                                                                stroke="currentColor"
                                                                stroke-width="2"
                                                                stroke-linecap="round"
                                                                stroke-linejoin="round"
                                                            >
                                                                <circle
                                                                    cx="11"
                                                                    cy="11"
                                                                    r="8"
                                                                ></circle>
                                                                <line
                                                                    x1="21"
                                                                    y1="21"
                                                                    x2="16.65"
                                                                    y2="16.65"
                                                                ></line>
                                                            </svg>
                                                            <span
                                                                class="action-label"
                                                                >Findings &
                                                                Tasks</span
                                                            >
                                                        </button>
                                                        <button
                                                            class="action-button icon-action"
                                                            onclick={showEmails}
                                                            data-area-id={area.id}
                                                            data-question-id={question.id}
                                                            title="Emails"
                                                        >
                                                            <svg
                                                                xmlns="http://www.w3.org/2000/svg"
                                                                width="20"
                                                                height="20"
                                                                viewBox="0 0 24 24"
                                                                fill="none"
                                                                stroke="currentColor"
                                                                stroke-width="2"
                                                                stroke-linecap="round"
                                                                stroke-linejoin="round"
                                                            >
                                                                <path
                                                                    d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"
                                                                ></path>
                                                                <polyline
                                                                    points="22,6 12,13 2,6"
                                                                ></polyline>
                                                            </svg>
                                                            <span
                                                                class="action-label"
                                                                >Emails</span
                                                            >
                                                        </button>
                                                    </div>
                                                </div>
                                            </template>
                                        </div>
                                    </template>
                                </div>
                            </template>
                        </div>

                        <!-- Action Buttons Container -->
                        <div class="action-buttons-container">
                            <button
                                class="action-button save-button main-action-button"
                                onclick={handleSaveAction}
                            >
                                <svg
                                    class="action-icon"
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="20"
                                    height="20"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                >
                                    <path
                                        d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"
                                    ></path>
                                </svg>
                                <span>Save</span>
                            </button>
                            <button
                                class="action-button review-button main-action-button"
                                onclick={handleCloseReviewAction}
                            >
                                <span class="action-icon review-icon"
                                    >&#10004;</span
                                >
                                <span>Close Review</span>
                            </button>
                        </div>
                    </div>

                    <!-- Right Panel for Details -->
                    <template if:true={isRightPanelOpen}>
                        <div class="right-panel">
                            <div class="panel-header">
                                <p><b>{displayHeader}</b></p>
                                <button
                                    class="icon-button"
                                    onclick={handleRightButtonClick}
                                    title="Close Panel"
                                >
                                    <svg
                                        width="20"
                                        height="20"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                    >
                                        <path
                                            d="M9 6l6 6-6 6"
                                            stroke="#5a3e84"
                                            stroke-width="2"
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                        />
                                    </svg>
                                </button>
                            </div>
                            <div class="panel-content">
                                <template if:true={openReviewComments}>
                                    <div
                                        class="comments-section chat-container"
                                    >
                                        <!-- Chat Messages - Displayed as alternating left/right messages -->
                                        <div class="chat-messages">
                                            <template
                                                for:each={chatMessagesWithClasses}
                                                for:item="message"
                                            >
                                                <div
                                                    key={message.id}
                                                    class={message.cssClass}
                                                >
                                                    <div
                                                        class="chat-message-content"
                                                    >
                                                        <div
                                                            class="chat-message-header"
                                                        >
                                                            <span
                                                                class="chat-message-sender"
                                                                >{message.sender}</span
                                                            >
                                                            <span
                                                                class="chat-message-time"
                                                                >{message.timestamp}</span
                                                            >
                                                        </div>
                                                        <div
                                                            class="chat-message-body"
                                                        >
                                                            <p>
                                                                {message.content}
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </template>
                                        </div>

                                        <!-- Chat Input with Salesforce Blue Send Icon -->
                                        <div class="chat-input-container">
                                            <textarea
                                                class="chat-input"
                                                placeholder="Type your message..."
                                                value={newChatMessage}
                                                onkeypress={handleChatKeyPress}
                                                onchange={handleChatInputChange}
                                            ></textarea>
                                            <button
                                                class="chat-send-button"
                                                onclick={handleSendChatMessage}
                                                title="Send Message"
                                            >
                                                <svg
                                                    class="send-icon"
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    width="20"
                                                    height="20"
                                                    viewBox="0 0 24 24"
                                                    fill="none"
                                                >
                                                    <path
                                                        d="M22 2L11 13"
                                                        stroke="#0070d2"
                                                        stroke-width="2"
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                    />
                                                    <path
                                                        d="M22 2L15 22L11 13L2 9L22 2Z"
                                                        stroke="#0070d2"
                                                        stroke-width="2"
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                    />
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                </template>

                                <!-- Findings and Tasks Section -->
                                <template if:true={showCapaForm}>
                                    <div class="findings-tasks-section">
                                        <h3>Findings</h3>

                                        <!-- Show existing findings if they exist for current question -->
                                        <template
                                            if:true={hasFindingsForCurrentQuestion}
                                        >
                                            <template
                                                for:each={assessmentFindings}
                                                for:item="finding"
                                            >
                                                <div
                                                    key={finding.id}
                                                    class="finding-card"
                                                >
                                                    <div class="finding-header">
                                                        <h4>{finding.name}</h4>
                                                        <span
                                                            class="finding-type"
                                                            >{finding.type}</span
                                                        >
                                                    </div>
                                                    <div
                                                        class="finding-details"
                                                    >
                                                        <p>
                                                            <strong
                                                                >Description:</strong
                                                            >
                                                            {finding.description}
                                                        </p>
                                                        <p>
                                                            <strong
                                                                >Root
                                                                Cause:</strong
                                                            >
                                                            {finding.rootCause}
                                                        </p>
                                                        <p>
                                                            <strong
                                                                >Repeat
                                                                Finding:</strong
                                                            >
                                                            {finding.repeatFinding}
                                                        </p>
                                                        <p>
                                                            <strong
                                                                >Resolution Time
                                                                Frame:</strong
                                                            >
                                                            {finding.resolutionTimeFrame}
                                                        </p>
                                                        <p>
                                                            <strong
                                                                >Assessment
                                                                Area:</strong
                                                            >
                                                            {finding.assessmentArea}
                                                        </p>
                                                        <p>
                                                            <strong
                                                                >Status:</strong
                                                            >
                                                            {finding.status}
                                                        </p>
                                                    </div>

                                                    <!-- Task Section -->
                                                    <div class="task-section">
                                                        <template
                                                            if:true={finding.hasTask}
                                                        >
                                                            <div
                                                                class="related-task"
                                                            >
                                                                <h5>
                                                                    Related Task
                                                                </h5>
                                                                <div
                                                                    class="task-details"
                                                                >
                                                                    <p>
                                                                        <strong
                                                                            >Subject:</strong
                                                                        >
                                                                        {finding.relatedTask.Subject}
                                                                    </p>
                                                                    <p>
                                                                        <strong
                                                                            >Status:</strong
                                                                        >
                                                                        {finding.relatedTask.Status}
                                                                    </p>
                                                                    <p>
                                                                        <strong
                                                                            >Priority:</strong
                                                                        >
                                                                        {finding.relatedTask.Priority}
                                                                    </p>
                                                                    <p>
                                                                        <strong
                                                                            >Due
                                                                            Date:</strong
                                                                        >
                                                                        {finding.relatedTask.ActivityDate}
                                                                    </p>
                                                                    <template
                                                                        if:true={finding.relatedTask.Description}
                                                                    >
                                                                        <p>
                                                                            <strong
                                                                                >Description:</strong
                                                                            >
                                                                            {finding.relatedTask.Description}
                                                                        </p>
                                                                    </template>
                                                                </div>
                                                            </div>
                                                        </template>
                                                        <template
                                                            if:false={finding.hasTask}
                                                        >
                                                            <!-- Create Task Button -->
                                                            <div
                                                                class="action-buttons"
                                                            >
                                                                <button
                                                                    class="slds-button slds-button_brand"
                                                                    onclick={handleCreateTask}
                                                                    data-finding-id={finding.id}
                                                                >
                                                                    Create New
                                                                    Task
                                                                </button>
                                                            </div>
                                                        </template>
                                                    </div>
                                                </div>
                                            </template>
                                        </template>

                                        <!-- Show create finding button if no findings exist -->
                                        <template
                                            if:false={hasFindingsForCurrentQuestion}
                                        >
                                            <div class="create-finding-section">
                                                <p>
                                                    No findings exist for this
                                                    question yet.
                                                </p>
                                                <button
                                                    class="slds-button slds-button_brand"
                                                    onclick={handleCreateFinding}
                                                >
                                                    Create New Finding
                                                </button>
                                            </div>
                                        </template>
                                    </div>
                                </template>

                                <template if:true={showTasksSection}>
                                    <div class="tasks-section">
                                        <template
                                            for:each={tasksForCurrentArea}
                                            for:item="task"
                                        >
                                            <div
                                                key={task.id}
                                                class="task-item"
                                            >
                                                <div class="task-subject">
                                                    <b>Task Subject:</b>
                                                    {task.subject}
                                                </div>
                                                <div class="task-comments">
                                                    <b>Comments:</b>
                                                    {task.comments}
                                                </div>
                                                <div class="task-dueDate">
                                                    <b>Due Date:</b>
                                                    {task.dueDate}
                                                </div>
                                            </div>
                                        </template>

                                        <!-- Only show Create Task button if no task exists for this area -->
                                        <template
                                            if:false={hasTasksForCurrentArea}
                                        >
                                            <button
                                                class="create-button"
                                                onclick={handleCreateTask}
                                            >
                                                Create New Task
                                            </button>
                                        </template>

                                        <!-- Show confirmation if task is created -->
                                        <template
                                            if:true={hasTasksForCurrentArea}
                                        >
                                            <div
                                                style="
                                                    margin-top: 10px;
                                                    padding: 10px;
                                                    background-color: #f0f7ff;
                                                    border-radius: 5px;
                                                    border-left: 3px solid
                                                        #28a745;
                                                "
                                            >
                                                <p
                                                    style="
                                                        margin: 0;
                                                        color: #155724;
                                                    "
                                                >
                                                    ✓ Task created successfully
                                                    for this assessment area.
                                                </p>
                                            </div>
                                        </template>
                                    </div>
                                </template>

                                <template if:true={openEmail}>
                                    <div class="emails-section">
                                        <div class="email-list">
                                            <div class="email-item">
                                                <div class="email-header">
                                                    <span class="email-subject"
                                                        >Tech Debt Assessment
                                                        Started</span
                                                    >
                                                    <span class="email-date"
                                                        >May-28-2025</span
                                                    >
                                                </div>
                                                <div class="email-meta">
                                                    <span class="email-from"
                                                        >From:
                                                        system@example.com</span
                                                    >
                                                    <span class="email-to"
                                                        >To:
                                                        user@example.com</span
                                                    >
                                                </div>
                                            </div>
                                            <div class="email-item">
                                                <div class="email-header">
                                                    <span class="email-subject"
                                                        >Assessment Follow-up
                                                        Required</span
                                                    >
                                                    <span class="email-date"
                                                        >May-29-2025</span
                                                    >
                                                </div>
                                                <div class="email-meta">
                                                    <span class="email-from"
                                                        >From:
                                                        admin@example.com</span
                                                    >
                                                    <span class="email-to"
                                                        >To:
                                                        user@example.com</span
                                                    >
                                                </div>
                                            </div>
                                        </div>
                                        <div class="email-compose">
                                            <button
                                                class="compose-button create-button"
                                            >
                                                Compose New Email
                                            </button>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </template>
                </div>
            </template>
            <template if:false={viewResponse}>
                <center>{labels.SP_Rep_Acc}</center>
            </template>

            <!-- Modal for mobile view -->
            <template if:true={showModal}>
                <div class="modal-backdrop">
                    <div class="modal-container">
                        <div class="modal-header">
                            <h2>{displayHeader}</h2>
                            <button class="icon-button" onclick={closeModal}>
                                <svg
                                    width="20"
                                    height="20"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                >
                                    <path
                                        d="M9 6l6 6-6 6"
                                        stroke="#5a3e84"
                                        stroke-width="2"
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                    />
                                </svg>
                            </button>
                        </div>
                        <div class="modal-content">
                            <template if:true={openReviewComments}>
                                <div class="comments-section chat-container">
                                    <!-- Chat Messages - Displayed as alternating left/right messages -->
                                    <div class="chat-messages">
                                        <template
                                            for:each={chatMessagesWithClasses}
                                            for:item="message"
                                        >
                                            <div
                                                key={message.id}
                                                class={message.cssClass}
                                            >
                                                <div
                                                    class="chat-message-content"
                                                >
                                                    <div
                                                        class="chat-message-header"
                                                    >
                                                        <span
                                                            class="chat-message-sender"
                                                            >{message.sender}</span
                                                        >
                                                        <span
                                                            class="chat-message-time"
                                                            >{message.timestamp}</span
                                                        >
                                                    </div>
                                                    <div
                                                        class="chat-message-body"
                                                    >
                                                        <p>{message.content}</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </template>
                                    </div>

                                    <!-- Chat Input with Salesforce Blue Send Icon -->
                                    <div class="chat-input-container">
                                        <textarea
                                            class="chat-input"
                                            placeholder="Type your message..."
                                            value={newChatMessage}
                                            onkeypress={handleChatKeyPress}
                                            onchange={handleChatInputChange}
                                        ></textarea>
                                        <button
                                            class="chat-send-button"
                                            onclick={handleSendChatMessage}
                                            title="Send Message"
                                        >
                                            <svg
                                                class="send-icon"
                                                xmlns="http://www.w3.org/2000/svg"
                                                width="20"
                                                height="20"
                                                viewBox="0 0 24 24"
                                                fill="none"
                                            >
                                                <path
                                                    d="M22 2L11 13"
                                                    stroke="#0070d2"
                                                    stroke-width="2"
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                />
                                                <path
                                                    d="M22 2L15 22L11 13L2 9L22 2Z"
                                                    stroke="#0070d2"
                                                    stroke-width="2"
                                                    stroke-linecap="round"
                                                    stroke-linejoin="round"
                                                />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </template>

                            <template if:true={showCapaForm}>
                                <div class="findings-tasks-section">
                                    <h3>Findings</h3>

                                    <!-- Show existing findings if they exist for current question -->
                                    <template
                                        if:true={hasFindingsForCurrentQuestion}
                                    >
                                        <template
                                            for:each={assessmentFindings}
                                            for:item="finding"
                                        >
                                            <div
                                                key={finding.id}
                                                class="finding-card"
                                            >
                                                <div class="finding-header">
                                                    <h4>{finding.name}</h4>
                                                    <span class="finding-type"
                                                        >{finding.type}</span
                                                    >
                                                </div>
                                                <div class="finding-details">
                                                    <p>
                                                        <strong
                                                            >Description:</strong
                                                        >
                                                        {finding.description}
                                                    </p>
                                                    <p>
                                                        <strong
                                                            >Root Cause:</strong
                                                        >
                                                        {finding.rootCause}
                                                    </p>
                                                    <p>
                                                        <strong
                                                            >Repeat
                                                            Finding:</strong
                                                        >
                                                        {finding.repeatFinding}
                                                    </p>
                                                    <p>
                                                        <strong
                                                            >Resolution Time
                                                            Frame:</strong
                                                        >
                                                        {finding.resolutionTimeFrame}
                                                    </p>
                                                    <p>
                                                        <strong
                                                            >Assessment
                                                            Area:</strong
                                                        >
                                                        {finding.assessmentArea}
                                                    </p>
                                                    <p>
                                                        <strong>Status:</strong>
                                                        {finding.status}
                                                    </p>
                                                </div>

                                                <!-- Task Section -->
                                                <div class="task-section">
                                                    <template
                                                        if:true={finding.hasTask}
                                                    >
                                                        <div
                                                            class="related-task"
                                                        >
                                                            <h5>
                                                                Related Task
                                                            </h5>
                                                            <div
                                                                class="task-details"
                                                            >
                                                                <p>
                                                                    <strong
                                                                        >Subject:</strong
                                                                    >
                                                                    {finding.relatedTask.Subject}
                                                                </p>
                                                                <p>
                                                                    <strong
                                                                        >Status:</strong
                                                                    >
                                                                    {finding.relatedTask.Status}
                                                                </p>
                                                                <p>
                                                                    <strong
                                                                        >Priority:</strong
                                                                    >
                                                                    {finding.relatedTask.Priority}
                                                                </p>
                                                                <p>
                                                                    <strong
                                                                        >Due
                                                                        Date:</strong
                                                                    >
                                                                    {finding.relatedTask.ActivityDate}
                                                                </p>
                                                                <template
                                                                    if:true={finding.relatedTask.Description}
                                                                >
                                                                    <p>
                                                                        <strong
                                                                            >Description:</strong
                                                                        >
                                                                        {finding.relatedTask.Description}
                                                                    </p>
                                                                </template>
                                                            </div>
                                                        </div>
                                                    </template>
                                                    <template
                                                        if:false={finding.hasTask}
                                                    >
                                                        <!-- Create Task Button -->
                                                        <div
                                                            class="action-buttons"
                                                        >
                                                            <button
                                                                class="slds-button slds-button_brand"
                                                                onclick={handleCreateTask}
                                                                data-finding-id={finding.id}
                                                            >
                                                                Create New Task
                                                            </button>
                                                        </div>
                                                    </template>
                                                </div>
                                            </div>
                                        </template>
                                    </template>

                                    <!-- Show create finding button if no findings exist -->
                                    <template
                                        if:false={hasFindingsForCurrentQuestion}
                                    >
                                        <div class="create-finding-section">
                                            <p>
                                                No findings exist for this
                                                question yet.
                                            </p>
                                            <button
                                                class="slds-button slds-button_brand"
                                                onclick={handleCreateFinding}
                                            >
                                                Create New Finding
                                            </button>
                                        </div>
                                    </template>
                                </div>
                            </template>

                            <template if:true={showTasksSection}>
                                <div class="tasks-section">
                                    <template
                                        for:each={tasksForCurrentArea}
                                        for:item="task"
                                    >
                                        <div key={task.id} class="task-item">
                                            <div class="task-subject">
                                                <b>Task Subject:</b>
                                                {task.subject}
                                            </div>
                                            <div class="task-comments">
                                                <b>Comments:</b> {task.comments}
                                            </div>
                                            <div class="task-dueDate">
                                                <b>Due Date:</b> {task.dueDate}
                                            </div>
                                        </div>
                                    </template>

                                    <!-- Only show Create Task button if no task exists for this area -->
                                    <template if:false={hasTasksForCurrentArea}>
                                        <button
                                            class="create-button"
                                            onclick={handleCreateTask}
                                        >
                                            Create New Task
                                        </button>
                                    </template>

                                    <!-- Show confirmation if task is created -->
                                    <template if:true={hasTasksForCurrentArea}>
                                        <div
                                            style="
                                                margin-top: 10px;
                                                padding: 10px;
                                                background-color: #f0f7ff;
                                                border-radius: 5px;
                                                border-left: 3px solid #28a745;
                                            "
                                        >
                                            <p
                                                style="
                                                    margin: 0;
                                                    color: #155724;
                                                "
                                            >
                                                ✓ Task created successfully for
                                                this assessment area.
                                            </p>
                                        </div>
                                    </template>
                                </div>
                            </template>

                            <template if:true={openEmail}>
                                <div class="emails-section">
                                    <div class="email-list">
                                        <div class="email-item">
                                            <div class="email-header">
                                                <span class="email-subject"
                                                    >Tech Debt Assessment
                                                    Started</span
                                                >
                                                <span class="email-date"
                                                    >May-28-2025</span
                                                >
                                            </div>
                                            <div class="email-meta">
                                                <span class="email-from"
                                                    >From:
                                                    system@example.com</span
                                                >
                                                <span class="email-to"
                                                    >To: user@example.com</span
                                                >
                                            </div>
                                        </div>
                                        <div class="email-item">
                                            <div class="email-header">
                                                <span class="email-subject"
                                                    >Assessment Follow-up
                                                    Required</span
                                                >
                                                <span class="email-date"
                                                    >May-29-2025</span
                                                >
                                            </div>
                                            <div class="email-meta">
                                                <span class="email-from"
                                                    >From:
                                                    admin@example.com</span
                                                >
                                                <span class="email-to"
                                                    >To: user@example.com</span
                                                >
                                            </div>
                                        </div>
                                    </div>
                                    <div class="email-compose">
                                        <button
                                            class="compose-button create-button"
                                        >
                                            Compose New Email
                                        </button>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </template>

            <!-- Custom Toast Notification -->
            <template if:true={isCustomToastVisible}>
                <div class={toastClasses}>
                    <template if:true={isSuccessToast}>
                        <svg
                            class="toast-icon"
                            width="20"
                            height="20"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="#28a745"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                        >
                            <polyline points="20 6 9 17 4 12"></polyline>
                        </svg>
                    </template>
                    <template if:true={isErrorToast}>
                        <svg
                            class="toast-icon"
                            width="20"
                            height="20"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="#dc3545"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                        >
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="15" y1="9" x2="9" y2="15"></line>
                            <line x1="9" y1="9" x2="15" y2="15"></line>
                        </svg>
                    </template>
                    <div class="toast-content">{customToastMessage}</div>
                    <button
                        class="toast-close-button"
                        onclick={closeCustomToast}
                    >
                        <svg
                            width="16"
                            height="16"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                        >
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
            </template>

            <!-- New Finding Modal -->
            <template if:true={isFindingModalOpen}>
                <div class="modal-backdrop">
                    <div class="modal-container">
                        <div class="modal-header">
                            <h2>Create New Finding</h2>
                            <button
                                class="icon-button"
                                onclick={handleCloseFindingModal}
                                title="Close"
                            >
                                <svg
                                    width="20"
                                    height="20"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                >
                                    <path
                                        d="M18 6L6 18M6 6l12 12"
                                        stroke="#5a3e84"
                                        stroke-width="2"
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                    />
                                </svg>
                            </button>
                        </div>
                        <div class="modal-content">
                            <div class="form-element">
                                <label for="finding-name"
                                    >Assessment Findings Name</label
                                >
                                <input
                                    type="text"
                                    id="finding-name"
                                    value={findingName}
                                    onchange={handleInputChange}
                                    data-field="findingName"
                                    required
                                />
                            </div>

                            <div class="form-element">
                                <label for="finding-type">Finding Type</label>
                                <select
                                    id="finding-type"
                                    value={findingType}
                                    onchange={handleInputChange}
                                    data-field="findingType"
                                    required
                                >
                                    <option value="">-- Select --</option>
                                    <option value="Major Non-Conformance">
                                        Major Non-Conformance
                                    </option>
                                    <option value="Minor Non-Conformance">
                                        Minor Non-Conformance
                                    </option>
                                    <option value="Observation">
                                        Observation
                                    </option>
                                </select>
                            </div>

                            <div class="form-element">
                                <label for="finding-description"
                                    >Finding Description</label
                                >
                                <textarea
                                    id="finding-description"
                                    value={findingDescription}
                                    onchange={handleInputChange}
                                    data-field="findingDescription"
                                    required
                                ></textarea>
                            </div>

                            <div class="form-element">
                                <label for="root-cause">Root Cause</label>
                                <select
                                    id="root-cause"
                                    value={rootCause}
                                    onchange={handleInputChange}
                                    data-field="rootCause"
                                    required
                                >
                                    <option value="">-- Select --</option>
                                    <option value="Lack of workers">
                                        Lack of workers
                                    </option>
                                    <option value="Equipment failure">
                                        Equipment failure
                                    </option>
                                    <option value="Process issue">
                                        Process issue
                                    </option>
                                </select>
                            </div>

                            <div class="form-element">
                                <label for="repeat-finding"
                                    >Repeat Finding</label
                                >
                                <select
                                    id="repeat-finding"
                                    value={repeatFinding}
                                    onchange={handleInputChange}
                                    data-field="repeatFinding"
                                    required
                                >
                                    <option value="">-- Select --</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>

                            <div class="form-element">
                                <label for="resolution-time"
                                    >Resolution Time Frame</label
                                >
                                <select
                                    id="resolution-time"
                                    value={resolutionTimeFrame}
                                    onchange={handleInputChange}
                                    data-field="resolutionTimeFrame"
                                    required
                                >
                                    <option value="">-- Select --</option>
                                    <option value="7 days">7 days</option>
                                    <option value="15 days">15 days</option>
                                    <option value="30 days">30 days</option>
                                    <option value="60 days">60 days</option>
                                </select>
                            </div>

                            <div class="form-element">
                                <label for="assessment-area"
                                    >Assessment Area</label
                                >
                                <input
                                    type="text"
                                    id="assessment-area"
                                    value={assessmentArea}
                                    onchange={handleInputChange}
                                    data-field="assessmentArea"
                                    required
                                />
                            </div>

                            <div class="form-element">
                                <label for="status">Status</label>
                                <select
                                    id="status"
                                    value={status}
                                    onchange={handleInputChange}
                                    data-field="status"
                                    required
                                >
                                    <option value="">-- Select --</option>
                                    <option value="Open">Open</option>
                                    <option value="In Progress">
                                        In Progress
                                    </option>
                                    <option value="Closed">Closed</option>
                                </select>
                            </div>

                            <div class="form-element file-upload">
                                <label>Upload</label>
                                <div class="upload-area">
                                    <input
                                        type="file"
                                        class="file-input"
                                        onchange={handleFileUpload}
                                        multiple
                                        hidden
                                    />
                                    <button
                                        class="upload-button"
                                        onclick={handleUploadButtonClick}
                                    >
                                        Upload Files
                                    </button>
                                    <span>Or drop files</span>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button
                                class="action-button close-button"
                                onclick={handleCloseFindingModal}
                            >
                                Close
                            </button>
                            <button
                                class="action-button save-button"
                                onclick={handleSaveFinding}
                            >
                                Save
                            </button>
                        </div>
                    </div>
                </div>
            </template>

            <!-- Create New Task Modal -->
            <template if:true={isTaskModalOpen}>
                <div class="modal-backdrop">
                    <div class="modal-container">
                        <div class="modal-header">
                            <h2>Task Details</h2>
                            <button
                                class="icon-button"
                                onclick={handleCloseTaskModal}
                                title="Close"
                            >
                                <svg
                                    width="20"
                                    height="20"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                >
                                    <path
                                        d="M18 6L6 18M6 6l12 12"
                                        stroke="#5a3e84"
                                        stroke-width="2"
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                    />
                                </svg>
                            </button>
                        </div>
                        <div class="modal-content">
                            <div class="form-element">
                                <label for="task-subject">Subject</label>
                                <input
                                    type="text"
                                    id="task-subject"
                                    value={taskSubject}
                                    onchange={handleTaskInputChange}
                                    data-field="taskSubject"
                                    required
                                />
                            </div>

                            <div class="form-element">
                                <label for="task-comments">Comments</label>
                                <textarea
                                    id="task-comments"
                                    value={taskComments}
                                    onchange={handleTaskInputChange}
                                    data-field="taskComments"
                                ></textarea>
                            </div>

                            <div class="form-element">
                                <label for="task-due-date">Due Date</label>
                                <input
                                    type="date"
                                    id="task-due-date"
                                    value={taskDueDate}
                                    onchange={handleTaskInputChange}
                                    data-field="taskDueDate"
                                    required
                                />
                            </div>

                            <div class="form-element">
                                <label for="task-priority">Priority</label>
                                <select
                                    id="task-priority"
                                    value={taskPriority}
                                    onchange={handleTaskInputChange}
                                    data-field="taskPriority"
                                    required
                                >
                                    <option value="">-- Select --</option>
                                    <option value="High">High</option>
                                    <option value="Medium">Medium</option>
                                    <option value="Low">Low</option>
                                </select>
                            </div>

                            <div class="form-element">
                                <label for="task-status">Status</label>
                                <select
                                    id="task-status"
                                    value={taskStatus}
                                    onchange={handleTaskInputChange}
                                    data-field="taskStatus"
                                    required
                                >
                                    <option value="">-- Select --</option>
                                    <option value="Open">Open</option>
                                    <option value="In Progress">
                                        In Progress
                                    </option>
                                    <option value="Closed">Closed</option>
                                </select>
                            </div>

                            <div class="form-element">
                                <label for="task-assigned-to"
                                    >Assigned To</label
                                >
                                <select
                                    id="task-assigned-to"
                                    class="form-select"
                                    value={selectedUserId}
                                    onchange={handleTaskInputChange}
                                    data-field="selectedUserId"
                                    required
                                >
                                    <template
                                        for:each={assignedToOptions}
                                        for:item="user"
                                    >
                                        <option key={user.id} value={user.id}>
                                            {user.name}
                                        </option>
                                    </template>
                                </select>
                            </div>

                            <div class="form-element file-upload">
                                <label>Upload</label>
                                <div class="upload-area">
                                    <input
                                        type="file"
                                        class="task-file-input"
                                        onchange={handleTaskFileUpload}
                                        multiple
                                        hidden
                                    />
                                    <button
                                        class="upload-button"
                                        onclick={handleTaskUploadButtonClick}
                                    >
                                        Upload Files
                                    </button>
                                    <span>Or drop files</span>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button
                                class="action-button close-button"
                                onclick={handleCloseTaskModal}
                            >
                                Close
                            </button>
                            <button
                                class="action-button save-button"
                                onclick={handleSaveTask}
                            >
                                Save
                            </button>
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </div>
</template>
