<template>
    <div class="checklist-container">
        <!-- Loading spinner -->
        <template if:true={isLoading}>
            <div class="loading-spinner">
                <div class="spinner"></div>
                <div class="loading-text">Loading checklists...</div>
            </div>
        </template>

        <!-- Error message -->
        <template if:true={error}>
            <div class="error-message">
                <div class="error-icon">⚠️</div>
                <div class="error-text">{error}</div>
            </div>
        </template>

        <!-- Desktop View: Table Layout -->
        <div class="desktop-view">
            <table class="checklist-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Status</th>
                        <th>Category</th>
                        <th>Created By</th>
                        <th>Last Modified By</th>
                        <th>Last Modified Date</th>
                    </tr>
                </thead>
                <tbody>
                    <template if:true={hasItems}>
                        <template for:each={items} for:item="item">
                            <tr key={item.id}>
                                <td>
                                    <a
                                        href="javascript:void(0)"
                                        onclick={handleChecklistClick}
                                        data-id={item.id}
                                        class="checklist-name-link"
                                        >{item.name}</a
                                    >
                                </td>
                                <td>
                                    <span class={item.statusClass}
                                        >{item.status}</span
                                    >
                                </td>
                                <td>{item.category}</td>
                                <td>{item.createdBy}</td>
                                <td>{item.lastModifiedBy}</td>
                                <td>
                                    <template if:true={item.lastModifiedDate}>
                                        {item.formattedLastModifiedDate}
                                    </template>
                                </td>
                            </tr>
                        </template>
                    </template>
                </tbody>
            </table>
            <div if:true={noData} class="no-data">
                No checklist items found.
            </div>
        </div>

        <!-- Mobile View: Card Layout -->
        <div class="mobile-view">
            <template if:true={hasItems}>
                <template for:each={visibleItems} for:item="item">
                    <div key={item.id} class="checklist-card">
                        <div class="card-content">
                            <div class="card-icon">
                                <svg
                                    viewBox="0 0 24 24"
                                    class="assessment-icon"
                                >
                                    <path
                                        d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7 10h2v7H7zm4-3h2v10h-2zm4 6h2v4h-2z"
                                    ></path>
                                </svg>
                            </div>
                            <div class="card-details">
                                <h3 class="card-title">
                                    <a
                                        href="javascript:void(0)"
                                        onclick={handleChecklistClick}
                                        data-id={item.id}
                                        class="checklist-name-link"
                                        >{item.name}</a
                                    >
                                </h3>
                                <div class="card-metadata">
                                    <div class="card-company">
                                        {item.category}
                                    </div>
                                    <div class="card-date">
                                        {item.formattedCreatedDate}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <span class={item.statusClass}>{item.status}</span>
                            <div class="card-menu">
                                <div class="dropdown">
                                    <span
                                        class="three-dots"
                                        onclick={handleToggleMenu}
                                        data-id={item.id}
                                        >&#8230;</span
                                    >
                                    <div
                                        class="dropdown-content"
                                        data-id={item.id}
                                    >
                                        <div
                                            class="dropdown-item"
                                            onclick={handleEdit}
                                            data-id={item.id}
                                        >
                                            Edit
                                        </div>
                                        <div
                                            class="dropdown-item"
                                            onclick={handleDelete}
                                            data-id={item.id}
                                        >
                                            Delete
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </template>
                <!-- View More Button -->
                <div if:true={showViewMoreButton} class="view-more-container">
                    <button class="view-more-button" onclick={handleViewMore}>
                        View More
                    </button>
                </div>
            </template>
            <div if:true={noData} class="no-data">
                No checklist items found.
            </div>
        </div>
    </div>
</template>
